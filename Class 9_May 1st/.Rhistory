data("mtcars")
head(mtcars)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
View(wisc.df)
knitr::opts_chunk$set(echo = TRUE)
url <- "https://bioboot.github.io/bimm143_S18/class-material/WisconsinCancer.csv"
wisc.df <- read.csv(url)
wisc.data <- as.matrix(wisc.df)
row.names(wisc.data) <- wisc.df$id
head(wisc.data)
View(wisc.df)
View(wisc.data)
diagnosis <- as.numeric(wisc.data)
View(wisc.data)
diagnosis <- as.matrix(wisc.data$diagonis)
diagnosis <- as.numeric(wisc.data$diagonis == M)
?as.numeric
url <- "https://bioboot.github.io/bimm143_S18/class-material/WisconsinCancer.csv"
wisc.df <- read.csv(url)
head(wisc.df)
url <- "https://bioboot.github.io/bimm143_S18/class-material/WisconsinCancer.csv"
wisc.df <- read.csv(url)
head(wisc.df)
diagnosis <- as.numeric(wisc.data, wisc.data$diagnosis == "M" )
table(wisc.df$diagnosis)
table(wisc.df$diagnosis)
diagnosis <- as.numeric(wisc.data, wisc.df$diagnosis == "M" )
diagnosis <- as.numeric(wisc.df, wisc.df$diagnosis == "M" )
diagnosis <- as.numeric(wisc.df$diagnosis == "M")
diagnosis <- as.numeric(wisc.df$diagnosis == "M")
diagnosis <- as.numeric(wisc.df$diagnosis == "M")
diagnosis
diagnosis <- as.numeric(wisc.df$diagnosis == "M")
diagnosis
table(diagnosis)
diagnosis <- as.numeric(wisc.df$diagnosis == "M")
table(diagnosis)
table(wisc.df$diagnosis)
table(wisc.df$diagnosis)
#Convert the features of the data: wisc.data
ncol(wisc.df)
#Convert the features of the data: wisc.data
wisc.data <-  as.matrix(wisc.df[,3:ncol(wisc.df)])
rownames(wisc.data) <- wisc.df$id
head(wisc.data)
wisc.data <-  as.matrix(wisc.df[,3:ncol(wisc.df)])
rownames(wisc.data) <- wisc.df$id
head(wisc.data)
table(wisc.df$id)
length(wisc.df)
length(wisc.df$diagnosis)
row(wisc.df)
length(row(wisc.df))
count(row(wisc.df))
length(row(wisc.df))
nrow(wisc.df)
nrow(wisc.data)
sum(diagnosis)
colnames(wisc.data)
colnames(wisc.data, "_mean")
ncolnames(wisc.data, "_mean")
count(colnames(wisc.data, "_mean"))
colnames(wisc.data, "_mean")
?grep
grep("_mean", colnames(wisc.data))
grep("_mean", colnames(wisc.data), value = FALSE)
grep("_mean", colnames(wisc.data), value = TRUE)
colMeans(wisc.data)
apply(wisc.data, 2, sd)
grep("_mean", colnames(wisc.data), value = TRUE)
length(grep("_mean", colnames(wisc.data))
grep("_mean", colnames(wisc.data), value = TRUE)
length(grep("_mean", colnames(wisc.data)))
?prcomp
View(wisc.data)
View(wisc.data)
wisc.pr <- prcomp(wisc.data)
wisc.pr <- prcomp(wisc.data, scale = TRUE)
wisc.pr <- prcomp(wisc.data, scale. = TRUE)
wisc.pr <- prcomp(wisc.data)
wisc.pr <- prcomp(wisc.data, scale. = TRUE)
wisc.pr <- prcomp(wisc.data, scale. = FALSE)
wisc.pr <- prcomp(wisc.data)
wisc.pr <- prcomp(wisc.data[,1:30])
wisc.pr <- prcomp(wisc.data[,1:30])
wisc.pr <- prcomp(wisc.data[,1:30], scale. = TRUE)
wisc.pr <- prcomp(wisc.data[,1:30], scale. = TRUE)
wisc.pr
summary(wisc.pr)
summary(wisc.pr)
wisc.pr[2,1]
View(wisc.pr)
as.matrix(wisc.pr)
wisc.pr[2,1]
summary(wisc.pr[2,1])
View(wisc.pr)
biplot(wisc.pr)
?plot
plot(wisc.pr, col = "blue",
xlab = "PC1", ylab = "PC2")
plot(wisc.pr, col = blue,
xlab = "PC1", ylab = "PC2")
plot(wisc.pr,
xlab = "PC1", ylab = "PC2")
biplot(wisc.pr,
xlab = "PC1", ylab = "PC2")
plot(wisc.pr$x[, c(1,2)], col = (diagnosis + 1)
xlab = "PC1", ylab = "PC2")
plot(wisc.pr$x[, c(1,2)], col = (diagnosis + 1),
xlab = "PC1", ylab = "PC2")
summary(wisc.pr)
plot(wisc.pr$x[, c(1,3)], col = (diagnosis + 1),
xlab = "PC1", ylab = "PC3")
barplot(pve, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(pve)), las = 2, axes = FALSE)
barplot(wisc.pr, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.data, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.data)), las = 2, axes = FALSE)
barplot(wisc.pr, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
?barplot
barplot(as.matrix(wisc.pr), ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(as.vector(wisc.pr), ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$x, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
View(wisc.pr)
barplot(wisc.pr$x, ylab = "Preent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr$x)), las = 2, axes = FALSE)
barplot(wisc.pr$x, ylab = "Precent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr$x)), las = 2, axes = FALSE)
barplot(wisc.pr$scale, ylab = "Precent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$center, ylab = "Precent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$rotation, ylab = "Precent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$sdev, ylab = "Precent of Variance Explained",
names.arg = paste0("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$sdev, ylab = "Precent of Variance Explained",
names.arg = paste("PC", 1:length(wisc.pr)), las = 2, axes = FALSE)
barplot(wisc.pr$sdev, ylab = "Precent of Variance Explained",
names.arg = paste("PC", 1:length(wisc.pr$sdev)), las = 2, axes = FALSE)
axis(2, at = wisc.pr, labels = round (wisc.pr, 2)*100)
barplot(wisc.pr$sdev, ylab = "Precent of Variance Explained",
names.arg = paste("PC", 1:length(wisc.pr$sdev)), las = 2, axes = FALSE)
axis(2, at = wisc.pr$sdev, labels = round (wisc.pr, 2)*100)
barplot(wisc.pr$sdev, ylab = "Precent of Variance Explained",
names.arg = paste("PC", 1:length(wisc.pr$sdev)), las = 2, axes = FALSE)
axis(2, at = wisc.pr$sdev, labels = round (wisc.pr$sdev, 2)*100)
plot(wisc.pr$x[, c(1,3)], col = (diagnosis + 1),
pch=as.vector(wisc.df$diagnosis)
xlab = "PC1", ylab = "PC3")
plot(wisc.pr$x[, c(1,3)], col = (diagnosis + 1),
pch= as.vector(wisc.df$diagnosis),
xlab = "PC1", ylab = "PC3")
plot(wisc.pr$x[, c(1,2)], col = (diagnosis + 1),
pch= as.vector(wisc.df$diagnosis),
xlab = "PC1", ylab = "PC2")
plot( wisc.pr$sdev , xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
pr.var <- wisc.pr$sdev^2
pve <- pr.var/sum(pr.var)
barplot(pve, ylab = "Precent of Variance Explained",
names.arg=paste0("PC",1:length(pve)), las=2, axes = FALSE)
axis(2, at=pve, labels=round(pve,2)*100 )
plot( wisc.pr$sdev , xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
plot( pve , xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
wics.hclust.clusters <- table(wisc.hclust.clusters, diagnosis)
wics.hclust.clusters <-hclust(dist(wisc.pr))
wics.hclust.clusters <-hclust(dist(wisc.pr$x))
table(wisc.hclust.clusters, diagnosis)
wics.hclust.clusters <-hclust(dist(wisc.pr$rotation))
table(wisc.hclust.clusters, diagnosis)
wics.hclust.clusters <-hclust(dist(wisc.pr$sdev))
table(wisc.hclust.clusters, diagnosis)
par(mfrow=c(1,2))
plot( pve , xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
plot(cumsum(pve), xlab = "Principal Component",
ylab = "Cumulative Proportion of Variance Explained",
ylim = c(0, 1), type = "o")
wics.hclust.clusters <- hclust(wisc.pr)
wics.hclust.clusters <- hclust()
wics.hclust.clusters <- hclust(dist())
wics.hclust.clusters <- hclust(dist(wisc.pr))
wics.hclust.clusters <- hclust(dist(wisc.pr/2))
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust.clusters <- hclust(data.dist)
table(wisc.hclust.clusters, diagnosis)
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust.clusters <- hclust(data.dist)
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust.clusters <- hclust(data.dist)
#Plot our hclust model tree
plot(wics.hclust.clusters)
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust<- hclust(data.dist)
#Plot our hclust model tree
plot(wics.hclust)
table(wisc.hclust, diagnosis)
table(wics.hclust, diagnosis)
table(list(wics.hclust), diagnosis)
table(sort(wics.hclust), diagnosis)
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust <- hclust(data.dist)
#Plot our hclust model tree
plot(wics.hclust)
abline(h = 20,col = "red")
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust <- hclust(data.dist)
#Plot our hclust model tree
plot(wics.hclust)
abline(h = 20,col = "red")
wisc.hclust. clusters <- cutree(wics.hclust, h = 20)
#Scale the wisc.data
data.scaled <- scale(wisc.data)
#calculate distance matix needed for hclust
data.dist <- dist(data.scaled)
#Clustering by hclust
wics.hclust <- hclust(data.dist)
#Plot our hclust model tree
plot(wics.hclust)
abline(h = 20,col = "red")
wisc.hclust.clusters <- cutree(wics.hclust, h = 20)
table(wisc.hclust.clusters, diagnosis)
table(wisc.hclust.clusters, diagnosis)
table(wisc.hclust.clusters)
wisc.km <- kmeans(wisc.pr, centers= 2, nstart= 20)
wisc.km <- kmeans(wisc.data, centers= 2, nstart= 20)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
wisc.km
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster, wisc.hclust.clusters)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.hclust.clusters, wisc.km$cluster)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wisc.km$cluster)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wics.hclust.clusters, wics.km)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wics.hclust.clusters, wisc.km)
wisc.km <- kmeans(wisc.data[1:30], centers= 2, nstart= 20)
table(wics.hclust.clusters, wisc.km$cluster)
wisc.km <- kmeans(scale(wisc.data[1:30], centers= 2, nstart= 20))
wisc.km <- kmeans(scale(wisc.data[1:30], 2, nstart= 20))
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20))
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wics.hclust.clusters, wisc.km$cluster)
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
#table(wics.hclust.clusters, wisc.km$cluster)
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
wisc.km$cluster
diagnosis
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
View(wisc.km)
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:33])
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
table(wisc.hclust.clusters, wics.km$cluster)
wisc.km <- kmeans(scale(wisc.data[1:31]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
wisc.km <- kmeans(scale(wisc.data[1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
wisc.km <- kmeans(scale(wisc.data[,1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis[1:30])
wisc.km <- kmeans(scale(wisc.data[,1:30]), 2, nstart= 20)
table(wisc.km$cluster, diagnosis)
table(wisc.hclust.clusters, wics.km$cluster)
table(wisc.hclust.clusters, wisc.km$cluster)
wisc.pr.hclust <- hclust(wisc.pr[7], method = "complete")
wisc.pr.hclust <- hclust(wisc.pr[7,], method = "complete")
wisc.pr.hclust <- hclust(wisc.pr[], method = complete)
wisc.pr.hclust <- hclust(wisc.pr, method = "complete"")
wisc.pr.hclust <- hclust(wisc.pr, method = "complete")
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete")
?hclust
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete")
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete", is.na(x)=FALSE)
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete", is.na(x)=TRUE)
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete"
wisc.pr.hclust <- hclust(wisc.pr$x[,1:7], method = "complete")
View(wisc.pr)
wisc.pr[["x"]]
wisc.pr$x[,1:7] <- dist(wisc.pr$x)
wisc.pr.hclust <- hclust(disc(wisc.pr$x[,1:7]), method = "complete")
wisc.pr.hclust <- hclust(dist(wisc.pr$x[,1:7]), method = "complete")
wisc.pr.hclust.clusters <- cutree(wisc.pr.hclust, k=4)
wisc.pr.hclust <- hclust(dist(wisc.pr$x[,1:7]), method = "complete")
plot(wisc.pr.hclust)
wisc.pr.hclust.clusters <- cutree(wisc.pr.hclust, k=4)
plot(wisc.pr.hclust)
wisc.pr.hclust.clusters <- cutree(wisc.pr.hclust, k=4)
plot(wisc.pr.hclust)
cutree(wisc.pr.hclust, k=4)
plot(wisc.pr.hclust)
abline(h = 20,col = "red")
cutree(wisc.pr.hclust, k=4)
plot(wisc.pr.hclust)
abline(h = 20,col = "red")
wisc.pr.hclust.clusters <- cutree(wisc.pr.hclust, k=4)
table(wisc.pr.hclust.clusters, diagnosis)
table(wisc.pr.hclust.clusters, diagnosis)
table(wisc.km@cluster,diagnosis)
table(wisc.pr.hclust.clusters, diagnosis)
table(wisc.km$cluster,diagnosis)
table(wisc.pr.hclust.clusters, diagnosis)
table(wisc.km$cluster,diagnosis)
table(wisc.hclust.clusters, diagnosis)
table(wisc.pr.hclust.clusters, diagnosis)
table(wisc.km$cluster,diagnosis)
table(wisc.hclust.clusters, diagnosis)
